## Emoji ä¸æ–‡æœ¬é‡å çš„é—®é¢˜


### é•¿è¯çŸ­è¯´

ç½‘é¡µä¸­ emoji è¡¨æƒ…ä¸æ–‡å­—çš„æ··æ’ï¼Œæ­£åœ¨æ¥è¯´æ²¡é—®é¢˜ï¼Œä½†å½“ä½ ä½¿ç”¨æ‰©å±•å±å¹•çš„æ—¶å€™ï¼Œå¹¶ä¸”æ‰©å±•å±åˆ†è¾¨ç‡ä¸å¤Ÿçš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°è¡¨æƒ…ä¸æ–‡å­—é‡å çš„æƒ…å†µã€‚

![](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/emoji-overlap-issue.jpg)

ç®—é—®é¢˜ï¼Œä¹Ÿä¸ç®—é—®é¢˜ï¼Œæ¯•ç«Ÿæ­£å¸¸ä½¿ç”¨æ²¡é—®é¢˜ã€‚

### è®©æˆ‘ä»¬å»æ¢ç´¢ä¸€ä¸‹åŸå› 

ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æ ·å¼ä»£ç å†™å¾—æœ‰é—®é¢˜ã€‚

ä¸ºäº†è¯æ˜è¿™ä¸æ˜¯æˆ‘ä»¬ä»£ç çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ‹¿å…¶ä»–ç½‘ç«™æ¥è¯•ä¸€è¯•ï¼Œè­¬å¦‚å¯¹äºæ’ç‰ˆæœ‰å“è¶Šè¿½æ±‚çš„Mediumï¼Œæˆ‘éšä¾¿æ‰¾äº†ç¯‡ [æ–‡ç« ](https://medium.com/@nodejs/fireside-chat-with-node-js-foundation-chairperson-todd-moore-vp-of-open-technology-at-ibm-cfb5a337a4fa
)ï¼Œæµåˆ©åœ°æ’å…¥äº†ä¸€æŠŠé‡‘é’¥åŒ™ğŸ”‘å¤–å¸¦ä¸¤ä¸ªç¬‘è„¸ã€‚

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/extend-display.png)
*ä¸»æ˜¾ç¤ºå™¨*


![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/normal-display.png)
*æ‰©å±•æ˜¾ç¤ºå™¨*


é‡å è¿˜æ˜¯è¿·ä¸€æ ·çš„å­˜åœ¨ç€ï¼Œç‰¹åˆ«æ˜¯é’¥åŒ™è¿™ä¸ªè¡¨æƒ…ï¼Œç‰¹åˆ«æ˜æ˜¾ï¼Œå› ä¸ºå®ƒæ˜¯å€¾æ–œçš„ï¼Œåƒä¸€æŠŠåˆºåˆ€ï¼Œç›´æ’éš”å£çš„è€ç‹ã€‚

ä¸ºäº†æ’é™¤æµè§ˆå™¨å¤–çš„æ ·å¼å¸¦æ¥çš„å½±å“ï¼Œæˆ‘ä»¬åšä¸ªå®éªŒã€‚

åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä»¥ä¸‹å†…å®¹æ‰“å¼€ä¸€ä¸ªçº¯å‡€è€Œä¸æ²¾æ·¤æ³¥çš„ html

```
data:text/html, <html contenteditable>
```

ç„¶åç²˜å…¥æµ‹è¯•æ–‡æœ¬ã€‚

```
ğŸ”‘HğŸ˜’ğŸ˜’is first foray into computing was wire wrapping a Fairchild SCMP chipset into a simple computer and then doing the same with a Zilog Z80. Building his own first computer and then teaching himself to program set him on a path to a career in the industry.Â 
```

chrome ä¸­ï¼š

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/chrome-plain-html-normal-display.png)
*ä¸»æ˜¾ç¤ºå™¨*

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/chrome-plain-html-extend-display.png)
*æ‰©å±•æ˜¾ç¤ºå™¨*

é—®é¢˜ä¾æ—§ï¼Œbutï¼Œåˆ°è¿™é‡Œæˆ‘æƒ³åˆ°ä¸€ç‚¹ã€‚ä¸é˜²å¤šèµ°ä¸€æ­¥ï¼Œå…¶ä»–æµè§ˆå™¨é‡Œé¢ä¹Ÿè¯•è¯•ã€‚

Safari ä¸‹ï¼š

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/safari-plain-html-normal-display.png)
*ä¸»æ˜¾ç¤ºå™¨*

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/safari-plain-html-extend-display.png)
*æ‰©å±•æ˜¾ç¤ºå™¨*


firefox ä¸‹ï¼š

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/firefox-plain-html-normal-display.png)
*ä¸»æ˜¾ç¤ºå™¨*

![ä¸»æ˜¾ç¤ºå™¨](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/firefox-plain-html-extend-display.png)
*æ‰©å±•æ˜¾ç¤ºå™¨*

ä¸å¯¹æ¯”ä¸çŸ¥é“ï¼Œä¸€å¯¹æ¯”çœŸæœ‰æ–™ï¼

ä»ä¸Šé¢çš„å¯¹æ¯”ç»“æœæ¥çœ‹ï¼ŒChrome ä¸­é‡å çš„é—®é¢˜å¾ˆæ˜æ˜¾ï¼Œä¸”åªæœ‰ chrome åœ¨æ‰©å±•å±ä¸­å±•ç¤ºæœ‰é‡å é—®é¢˜ï¼Œå…¶ä»–æµè§ˆå™¨æ²¡é—®é¢˜ï¼Œè¿™ä¸å¾—ä¸è®©äººæ€€ç–‘ chrome æ¸²æŸ“æœ‰é—®é¢˜ä¸«ã€‚

äºæ˜¯ï¼Œæœæ–­ç»™ Chromium fileäº†ä¸ª bug å…ˆ ã€‚

[Issue 784780](https://bugs.chromium.org/p/chromium/issues/detail?id=784780&can=4&q=&colspec=ID%20Pri%20M%20Stars%20ReleaseBlock%20Component%20Status%20Owner%20Summary%20OS%20Modified)

é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå‰ç«¯èƒ½åšä»€ä¹ˆå‘¢ã€‚

### å¦‚æœåœ¨å‰ç«¯å…¼å®¹å‘¢ï¼Ÿ

å¦‚æœèƒ½åœ¨å†…å®¹ç”Ÿæˆé˜¶æ®µè¿›è¡Œæ§åˆ¶ï¼Œé‚£å°±å¥½åŠäº†ï¼Œå¯ä»¥å°† emoji åŒ…ä¸€å±‚ `span` æ ‡ç­¾ï¼Œç„¶åå°±å¯ä»¥éšæ„å†™æ ·å¼äº†ï¼Œå°±å¯ä»¥æ‰‹åŠ¨ç»™è¡¨æƒ…åŠ ä¸Šè¾¹è·ã€‚

ä½†çœŸå®æƒ…å†µä¸‹ emoji ä¸æ–‡æœ¬æ˜¯ä¸€ä½“çš„ï¼Œå¹¶ä¸å¥½å•ç‹¬æŠ½ç¦»å‡ºæ¥ã€‚å¦‚æœä¸èƒ½å†å†…å®¹äº§ç”Ÿçš„åœ°æ–¹è¿›è¡Œæ§åˆ¶ï¼Œé‚£å°±åªèƒ½åœ¨æ‹¿åˆ°å†…å®¹åè¿›è¡Œå¤„ç†ã€‚

### emoji çš„æ£€æµ‹

åŸºæœ¬ä¸Šï¼Œè¡¨æƒ…ä¹Ÿæ˜¯å­—ç¬¦ï¼Œå¯ä»¥ç”¨æ­£åˆ™åƒåŒ¹é…ä¸€èˆ¬å­—ç¬¦é‚£æ ·ç”¨ ASCII å€¼å»åŒ¹é…ã€‚
ä½†äº‹ç‰©æ€»æ˜¯å‘å±•å˜åŒ–çš„ï¼Œä¸æ–­æœ‰æ–°çš„è¡¨æƒ…åŠ å…¥åˆ°è¡¨æƒ…åŒ…ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´è¡¨æƒ…çš„ ASCII å€¼å¹¶æ²¡æœ‰ä¸€ä¸ªå›ºå®šçš„èŒƒå›´ã€‚ç›®å‰å°šæ²¡æœ‰ä»»ä½•å®˜æ–¹ç»„ç»‡æˆ–è€…æœºæ„å®£ç§°ä¸€å¥—å¯ä¿¡çš„èŒƒå›´ã€‚

é€šè¿‡ä»¥ä¸‹çš„æ­£åˆ™ï¼Œèƒ½å¤ŸåŒ¹é…å¤§éƒ¨åˆ†å·²è¢«å‘ç°çš„ emojiã€‚

```
(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])
```

[è¿™ç¯‡æ–‡ç« ](https://medium.com/reactnative/emojis-in-javascript-f693d0eb79fb)æœ‰ä¸“é—¨è®¨è®ºå¦‚ä½•å¾—å‡ºä»¥ä¸Šæ­£åˆ™å¹¶å¯¹ä»¥ä¸Šæ­£åˆ™çš„æ­£ç¡®æ€§è´Ÿè´£ã€‚

æµ‹è¯•ä¸€æ³¢ï¼š

```js
$0.innerHTML = $0.textContent.replace(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g,function(a){
	return '<span>'+a+'</span>'
})
```

![æŠ½å–åŠå¤„ç†æ–‡ä»¶ä¸­çš„è¡¨æƒ…](https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/emoji-overlapping-issue/assets/emoji-abstract.png)
*æŠ½å–åŠå¤„ç†æ–‡ä»¶ä¸­çš„è¡¨æƒ…*

### ç›¸å…³èµ„æº

- [How to detect emoji using javascript](https://stackoverflow.com/a/41164587/1553656)
- [Emojis in Javascript](https://medium.com/reactnative/emojis-in-javascript-f693d0eb79fb) 


