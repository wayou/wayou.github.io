<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="google-site-verification"
    content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"
  />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <meta name="description" content="notes about the coding life" />
  <meta name="keywords" content="ç‰›å“‡å‹‡, åšå®¢, äº’è”ç½‘, Web, JavaScript, å‰ç«¯, è®¾è®¡" />
  <meta name="theme-color" content="#000000" />

  <!-- Open Graph -->
  <meta
    property="og:title"
    content="Webpack SplitChunksPlugin çš„ä¸‰ç§æ¨¡å¼ - ç‰›ã•ã‚“ã®éƒ¨è½æ ¼|åˆ˜å“‡å‹‡çš„éƒ¨è½æ ¼"
  />
  
  <meta property="og:type" content="article" />
  <meta
    property="og:description"
    content="Webpack SplitChunksPlugin çš„ä¸‰ç§æ¨¡å¼

è‡ª Webpack 4 å¼€å§‹ï¼Œè‡ªå¸¦çš„ SplitChunksPlugin æ›¿ä»£äº†ä¹‹å‰çš„ CommonsChunkPlugin æ’ä»¶ï¼Œå¯¹ä»£ç è‡ªåŠ¨è¿›è¡Œæ‹†åˆ†ï¼ˆCode Splitï¼‰çš„ä¼˜åŒ–ï¼Œå¹¶ä¼´éšä¸€ä¸ªé»˜è®¤çš„é…ç½®èƒ½æ»¡è¶³å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„ä»£ç ä¼˜åŒ–ã€‚

sync ä¸ asycn è„šæœ¬

ç»§ç»­ä¹‹å‰å…ˆè®¨è®ºä¸€ä¸‹ sync ä¸ async ç±»å‹çš„è„šæœ¬ã€‚..."
  />
   <meta property="article:published_time" content="2019-03-10T17:03:00Z">    
  <meta property="og:image" content="http://0.0.0.0:4000" />
  <meta property="og:url" content="http://0.0.0.0:4000/2019/03/10/Webpack-SplitChunksPlugin-%E7%9A%84%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F/" />
  <meta property="og:site_name" content="ç‰›ã•ã‚“ã®éƒ¨è½æ ¼|åˆ˜å“‡å‹‡çš„éƒ¨è½æ ¼" />

  <title>
    Webpack SplitChunksPlugin çš„ä¸‰ç§æ¨¡å¼ - ç‰›ã•ã‚“ã®éƒ¨è½æ ¼|åˆ˜å“‡å‹‡çš„éƒ¨è½æ ¼
  </title>

  <!-- Web App Manifest -->
  <link rel="manifest" href="/pwa/manifest.json" />

  <!-- Favicon -->
  <link rel="shortcut icon" href="/favicon.ico" />

  <!-- Canonical URL -->
  <link
    rel="canonical"
    href="http://0.0.0.0:4000/2019/03/10/Webpack-SplitChunksPlugin-%E7%9A%84%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F/"
  />

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/hux-blog.min.css">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- ga & ba script hoook -->
  <script></script>
</head>


  <!-- hack iOS CSS :active style -->
  <body ontouchstart="">
    <!-- Navigation -->

  <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header page-scroll">
        <button type="button" class="navbar-toggle">
          <span class="sr-only">âŒ</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">ç‰›ã•ã‚“ã®éƒ¨è½æ ¼</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div id="huxblog_navbar">
        <div class="navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="/">ä¸»é¡µ</a>
            </li>
               
            <li>
              <a href="/about/"
                >å…³äº</a
              >
            </li>
              
            <li>
              <a href="/archive/"
                >å­˜æ¡£</a
              >
            </li>
                                                                   
          </ul>
        </div>
      </div>
      <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
  </nav>

  <script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body = document.body;
    var $toggle = document.querySelector(".navbar-toggle");
    var $navbar = document.querySelector("#huxblog_navbar");
    var $collapse = document.querySelector(".navbar-collapse");

    var __HuxNav__ = {
      close: function () {
        $navbar.className = " ";
        // wait until animation end.
        setTimeout(function () {
          // prevent frequently toggle
          if ($navbar.className.indexOf("in") < 0) {
            $collapse.style.height = "0px";
          }
        }, 400);
      },
      open: function () {
        $collapse.style.height = "auto";
        $navbar.className += " in";
      },
    };

    // Bind Event
    $toggle.addEventListener("click", function (e) {
      if ($navbar.className.indexOf("in") > 0) {
        __HuxNav__.close();
      } else {
        __HuxNav__.open();
      }
    });

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from
     * $toggle/$collapse will break global delegation.
     *
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener("click", function (e) {
      if (e.target == $toggle) return;
      if (e.target.className == "icon-bar") return;
      __HuxNav__.close();
    });
  </script>
</nav>
 <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                    </div>
                    <h1>Webpack SplitChunksPlugin çš„ä¸‰ç§æ¨¡å¼</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by ç‰›ã•ã‚“ã®éƒ¨è½æ ¼ on March 10, 2019</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<h1 id="webpack-splitchunksplugin-çš„ä¸‰ç§æ¨¡å¼">Webpack SplitChunksPlugin çš„ä¸‰ç§æ¨¡å¼</h1>

<p>è‡ª Webpack 4 å¼€å§‹ï¼Œè‡ªå¸¦çš„ <code class="language-plaintext highlighter-rouge">SplitChunksPlugin</code> æ›¿ä»£äº†ä¹‹å‰çš„ <code class="language-plaintext highlighter-rouge">CommonsChunkPlugin</code> æ’ä»¶ï¼Œå¯¹ä»£ç è‡ªåŠ¨è¿›è¡Œæ‹†åˆ†ï¼ˆCode Splitï¼‰çš„ä¼˜åŒ–ï¼Œå¹¶ä¼´éšä¸€ä¸ªé»˜è®¤çš„é…ç½®èƒ½æ»¡è¶³å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„ä»£ç ä¼˜åŒ–ã€‚</p>

<h3 id="sync-ä¸-asycn-è„šæœ¬">sync ä¸ asycn è„šæœ¬</h3>

<p>ç»§ç»­ä¹‹å‰å…ˆè®¨è®ºä¸€ä¸‹ sync ä¸ async ç±»å‹çš„è„šæœ¬ã€‚</p>

<ul>
  <li>sync ç±»å‹çš„è„šæœ¬éœ€è¦åŒæ­¥åŠ è½½åˆ°é¡µé¢ï¼Œbundle ä¸­æ­£å¸¸ import/require çš„ä»£ç ã€‚è¿™ç§ sync ç±»å‹çš„ä»£ç ç”Ÿæˆçš„ bundle è„šæœ¬æ˜¯é€šè¿‡åœ¨é¡µé¢å†™ <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> æ ‡ç­¾è¿›è¡ŒåŠ è½½çš„ã€‚å¦‚æœæœ‰å¤šä¸ªè¿™æ ·çš„è„šæœ¬ï¼Œéœ€è¦æŒ‰é¡ºåºå†™æ ‡ç­¾è¿›è¡ŒåŠ è½½ã€‚</li>
  <li>async ç±»å‹çš„è„šæœ¬æ˜¯é€šè¿‡å¼‚æ­¥æ‹‰å–ï¼ŒæŒ‰éœ€åŠ è½½åˆ°é¡µé¢ä¸­çš„ï¼Œæ¯”å¦‚ä»£ç ä¸­ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">import()</code> åŠ è½½çš„è„šæœ¬ã€‚</li>
</ul>

<p><em>å°è´´å£«ï¼šè¿™é‡Œé¡ºä¾¿åŒºåˆ†ä¸€ä¸‹ <code class="language-plaintext highlighter-rouge">bundle</code> ä¸ <code class="language-plaintext highlighter-rouge">chunk</code>ã€‚å‰è€…æ˜¯ä¸ªæ›´å¤§çš„å•ä½ï¼Œå¯ç†è§£æˆæ ¹æ® <code class="language-plaintext highlighter-rouge">entry</code> é…ç½®ç”Ÿæˆçš„ä¸€ä¸ªè¾“å‡ºï¼Œè€Œ chunk å¯ç†è§£æˆä» bundle ä¸­æ‹†åˆ†å‡ºæ¥çš„æ›´å°ç²’åº¦ä»£ç å½¢æˆçš„æ–‡ä»¶ã€‚æœ¬è´¨ä¸Šè¿™ä¸ªç•Œå®šä¹Ÿæ²¡é‚£ä¹ˆä¸¥æ ¼ï¼Œæˆ–è€…è§£é‡Šä¹Ÿæ²¡æœ‰é‚£ä¹ˆç»Ÿä¸€ï¼Œåªæ˜¯å¯ä»¥è¿™å…ˆä¹ˆç†è§£ã€‚</em></p>

<h3 id="é»˜è®¤é…ç½®">é»˜è®¤é…ç½®</h3>

<p><code class="language-plaintext highlighter-rouge">SplitChunksPlugin</code> çš„é»˜è®¤é…ç½®ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">//...</span>
  <span class="na">optimization</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">splitChunks</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">chunks</span><span class="p">:</span> <span class="dl">"</span><span class="s2">async</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">minSize</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
      <span class="na">maxSize</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">minChunks</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">maxAsyncRequests</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="na">maxInitialRequests</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="na">automaticNameDelimiter</span><span class="p">:</span> <span class="dl">"</span><span class="s2">~</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">cacheGroups</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">vendors</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">[\\/]</span><span class="sr">node_modules</span><span class="se">[\\/]</span><span class="sr">/</span><span class="p">,</span>
          <span class="na">priority</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span>
        <span class="p">},</span>
        <span class="na">default</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">minChunks</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="na">priority</span><span class="p">:</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span>
          <span class="na">reuseExistingChunk</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>é»˜è®¤é…ç½®ä¸‹ï¼Œä¼šæ ¹æ®å¦‚ä¸‹æ¡ä»¶è¿›è¡Œä»£ç ä¼˜åŒ–ï¼š</p>

<ul>
  <li>ä¼˜åŒ–åªé’ˆå¯¹åŠ¨æ€å¼•å…¥çš„æ¨¡å—ï¼Œå³ async ç±»å‹è„šæœ¬ï¼Œå› ä¸ºå¯¹åŸå§‹ï¼ˆinitialï¼‰ sync ç±»å‹çš„ bundle è¿›è¡Œæ‹†åˆ†ä¼šäº§ç”Ÿæ–°çš„ bundleï¼Œè¿™ä¸ªæ–°äº§ç”Ÿçš„ bundle éœ€è¦è¢«æ­£ç¡®åœ°åœ¨é¡µé¢å¼•å…¥æ‰èƒ½å·¥ä½œï¼Œè¿™è¶…å‡ºäº† Webpack ä½œä¸ºè„šæœ¬ç¼–è¯‘çš„èŒƒç•´ï¼ˆå°†è„šæœ¬æ’å…¥é¡µé¢æ˜¯ <a href="https://github.com/jantimon/html-webpack-plugin">html-webpack-plugin</a> å¹²çš„äº‹æƒ…ï¼‰ã€‚</li>
  <li>æ–°äº§ç”Ÿçš„ chunk æ¥è‡ª <code class="language-plaintext highlighter-rouge">node_modules</code> æˆ–å¯è¢«å¤šä¸ªåœ°æ–¹å¤ç”¨ã€‚</li>
  <li>æ–° chunk éœ€è¦å¤§äº 30kbã€‚</li>
  <li>å¯¹ chunks çš„æœ€å¤§åŒæ—¶è¯·æ±‚æ•°å°äºç­‰äº 5ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæ‹†åˆ†åå¯¼è‡´ bundle éœ€è¦åŒæ—¶å¼‚æ­¥åŠ è½½çš„ chunk æ•°é‡å¤§äº 5 ä¸ªæˆ–æ›´å¤šæ—¶ï¼Œåˆ™ä¸ä¼šè¿›è¡Œæ‹†åˆ†ï¼Œå› ä¸ºå¢åŠ äº†è¯·æ±‚æ•°ï¼Œå¾—ä¸å¿å¤±ã€‚</li>
  <li>æ‹†åˆ†åéœ€è¦å°½é‡åšåˆ°å¯¹äºå…¥å£æ–‡ä»¶ä¸­æœ€å¤§åŒæ—¶è¯·æ±‚æ•°æ§åˆ¶åœ¨ 3 ä¸ªä»¥å†…ã€‚</li>
</ul>

<p>åœ¨æ»¡è¶³æœ€åä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œå†³å®šäº† chunks åº”è¶Šå¤§è¶Šå¥½ï¼Œè€Œä¸æ˜¯è¶Šå¤šã€‚</p>

<h3 id="chunks-é…ç½®é¡¹">chunks é…ç½®é¡¹</h3>

<p>è¿™é‡Œä¸»è¦è®¨è®ºé…ç½®ä¸­çš„ <code class="language-plaintext highlighter-rouge">chunks</code> é…ç½®é¡¹ã€‚å®ƒçš„å¯é€‰å€¼æœ‰</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">async</code>: åªä¼˜åŒ–åŠ¨æ€åŠ è½½çš„ä»£ç ï¼Œå…¶ä»–ç±»å‹çš„ä»£ç æ­£å¸¸æ‰“åŒ…ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">initial</code>: é’ˆå¯¹åŸå§‹ bundle ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">all</code>: é’ˆå¯¹æ‰€æœ‰ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">function(chunk)</code> è‡ªå®šä¹‰æ‹†åˆ†å‡½æ•°ï¼Œä¸è®¨è®º</li>
</ul>

<p>æ‰€ä»¥ä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œç‰¹åˆ«æ˜¯ initial æ–¹å¼ï¼Œç©¶ç«Ÿä¼šäº§ç”Ÿæ€æ ·çš„æ•ˆæœã€‚è¿™å°±æ˜¯æœ¬æ–‡è¦æ¢ç©¶çš„ã€‚</p>

<h4 id="ç¤ºä¾‹">ç¤ºä¾‹</h4>

<p>ä¸‹é¢é€šè¿‡ç¤ºä¾‹çœ‹çœ‹ä¸‰è€…åœ¨å¯¹æ­£å¸¸ä¸åŠ¨æ€åŠ è½½çš„ä»£ç æ•ˆæœä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ç¤ºä¾‹å€Ÿç”¨è‡ª <a href="https://medium.com/dailyjs/webpack-4-splitchunks-plugin-d9fbbe091fd0">Webpack 4 â€” Mysterious SplitChunks Plugin</a>ï¼Œæœ‰è°ƒæ•´ã€‚é€šè¿‡ <a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">webpack-bundle-analyzer</a> æŸ¥çœ‹ç¼–è¯‘è¾“å‡ºçš„ç»„æˆæƒ…å†µã€‚</p>

<p><em>a.js</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span><span class="p">(</span><span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">);</span>
<span class="k">import</span> <span class="dl">"</span><span class="s2">jquery</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">a</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p><em>b.js</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span><span class="p">(</span><span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">);</span>
<span class="k">import</span><span class="p">(</span><span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">);</span>
<span class="k">import</span> <span class="dl">"</span><span class="s2">jquery</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">b</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p><em>webpack.config.js</em></p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">module.exports = {
</span>  entry: {
    a: "./a.js",
    b: "./b.js"
  },
  output: {
    filename: "[name].bundle.js"
  },
  optimization: {
    splitChunks: {
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
<span class="gi">+          chunks: "async",
</span>          priority: 1
        }
      }
    }
  },
  plugins: [new BundleAnalyzerPlugin()]
<span class="err">};</span>
</code></pre></div></div>

<p>å‡†å¤‡äº†ä¸¤ä¸ªå…¥å£æ–‡ä»¶ï¼Œéƒ½å¼•å…¥äº†ä¸‰ä¸ª npm åº“ï¼Œjquery,react,lodashã€‚</p>

<ul>
  <li>jquery å‡åŒæ­¥å¼•å…¥</li>
  <li>å…¶ä¸­ react åœ¨ a æ–‡ä»¶åŒæ­¥å¼•å…¥è€Œ b ä¸­åŠ¨æ€åŠ è½½ï¼Œ</li>
  <li>lodash åœ¨ä¸¤è€…ä¸­å‡åŠ¨æ€å¼•å…¥</li>
</ul>

<h4 id="async">async</h4>

<p>æ ¹æ®ä¸Šé¢çš„é…ç½®ï¼Œæ‰§è¡Œ <code class="language-plaintext highlighter-rouge">npx webpack</code> å…ˆçœ‹ async æ¨¡å¼ä¸‹çš„è¾“å‡ºã€‚</p>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/webpack-code-split-issue/assets/async.png" alt="async æ¨¡å¼ä¸‹çš„è¾“å‡º" /></p>

<p><em>async æ¨¡å¼ä¸‹çš„è¾“å‡º</em></p>

<ul>
  <li>åœ¨ a,b ä¸­å‡åŒæ­¥å¼•å…¥çš„ jquery è¢«æ‰“åŒ…è¿›äº†å„è‡ªçš„ bundle ä¸­æ²¡æœ‰æ‹†åˆ†å‡ºæ¥å…±ç”¨ï¼Œå› ä¸ºè¿™ç§æ¨¡å¼ä¸‹åªä¼šä¼˜åŒ–åŠ¨æ€åŠ è½½çš„ä»£ç ã€‚</li>
  <li>react æ‰“äº†ä¸¤ä»½
    <ul>
      <li>ä¸€ä»½åœ¨ a è‡ªå·±çš„ bundle ä¸­ï¼Œå› ä¸ºå®ƒåŒæ­¥å¼•å…¥äº† reactï¼Œè€Œæˆ‘ä»¬åªä¼˜åŒ–åŠ¨æ€åŠ è½½çš„ä»£ç ï¼Œæ‰€ä»¥è¿™é‡Œçš„ react ä¸ä¼šè¢«ä¼˜åŒ–æ‹†åˆ†å‡ºå»ã€‚</li>
      <li>ä¸€ä»½åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œå®ƒæ˜¯ä» b é‡Œé¢æ‹†å‡ºæ¥çš„ï¼Œå› ä¸º b ä¸­åŠ¨æ€åŠ è½½äº† reactã€‚</li>
    </ul>
  </li>
  <li>lodash å› ä¸ºåœ¨ a,b ä¸­éƒ½æ˜¯åŠ¨æ€åŠ è½½ï¼Œå½¢æˆäº†å•ç‹¬çš„ chunk è¢« a, b å…±ç”¨ã€‚</li>
</ul>

<h4 id="initial">initial</h4>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/webpack-code-split-issue/assets/initial.png" alt="`initial` æ¨¡å¼ä¸‹çš„è¾“å‡º" /></p>

<p><em><code class="language-plaintext highlighter-rouge">initial</code> æ¨¡å¼ä¸‹çš„è¾“å‡º</em></p>

<p><code class="language-plaintext highlighter-rouge">initial</code> å³åŸå§‹çš„æ‹†åˆ†ï¼ŒåŸåˆ™å°±æ˜¯æœ‰å…±ç”¨çš„æƒ…å†µå³å‘ç”Ÿæ‹†åˆ†ã€‚åŠ¨æ€å¼•å…¥çš„ä»£ç ä¸å—å½±å“ï¼Œå®ƒæ˜¯æ— è®ºå¦‚ä½•éƒ½ä¼šèµ°æ‹†åˆ†é€»è¾‘çš„ï¼ˆæ¯•ç«Ÿä½ è¦åŠ¨æ€å¼•å…¥å˜›ï¼Œä¸æ‹†åˆ†æˆå•ç‹¬çš„æ–‡ä»¶æ€ä¹ˆåŠ¨æ€å¼•å…¥ï¼Ÿï¼ï¼‰ã€‚è€Œå¯¹äºåŒæ­¥å¼•å…¥çš„ä»£ç ï¼Œå¦‚æœæœ‰å¤šå¤„éƒ½åœ¨ä½¿ç”¨ï¼Œåˆ™æ‹†åˆ†å‡ºæ¥å…±ç”¨ã€‚</p>

<ul>
  <li>jquery åœ¨è¿™ç§æ¨¡å¼ä¸‹å‘ç”Ÿäº†å˜åŒ–ã€‚å½¢æˆäº†å•ç‹¬çš„ chunk ä¾› a,b å…±ç”¨ã€‚</li>
  <li>react æ²¡æœ‰å˜ï¼Œå› ä¸ºå®ƒåœ¨ a,b ä¸­å¼•ç”¨çš„æ–¹å¼ä¸åŒï¼Œæ‰€ä»¥ä¸ä¼šè¢«å½“æˆåŒä¸€ä¸ªæ¨¡å—æ‹†åˆ†å‡ºæ¥å…±ç”¨ï¼Œè€Œæ˜¯èµ°å„è‡ªçš„æ‰“åŒ…é€»è¾‘ã€‚åœ¨ a ä¸­åŒæ­¥å¼•ç”¨ï¼Œè¢«æ‰“å…¥äº† a çš„ bundleã€‚åœ¨ b ä¸­åŠ¨æ€å¼•å…¥æ‰€ä»¥æ‹†åˆ†æˆäº†å•ç‹¬çš„æ–‡ä»¶ä¾› b ä½¿ç”¨ã€‚</li>
  <li>lodash æ²¡å˜ï¼Œå½¢æˆå•ç‹¬ä¸€ä»½ä¸¤è€…å…±ç”¨ã€‚</li>
</ul>

<h4 id="all">all</h4>

<p>ä»ä¸Šé¢ <code class="language-plaintext highlighter-rouge">initial</code> æ¨¡å¼ä¸‹æˆ‘ä»¬ä¼¼ä¹çœ‹å‡ºäº†é—®é¢˜ï¼Œå³ åœ¨ a ä¸­åŒæ­¥å¼•å…¥åœ¨ b ä¸­åŠ¨æ€å¼•å…¥çš„ reactï¼Œå®ƒå…¶å®å¯ä»¥è¢«æŠ½æˆæ–‡ä»¶ä¾›ä¸¤è€…å…±ç”¨çš„ï¼Œåªæ˜¯å› ä¸ºå¼•å…¥æ–¹å¼ä¸åŒè€Œæ²¡æœ‰è¿™æ ·åšã€‚</p>

<p>æ‰€ä»¥ <code class="language-plaintext highlighter-rouge">all</code> è¿™ç§æ¨¡å¼ä¸‹ï¼Œå°±ä¼šæ™ºèƒ½åœ°è¿›è¡Œåˆ¤æ–­ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ­¤æ—¶ä¸å…³å¿ƒå¼•å…¥çš„æ¨¡å—æ˜¯åŠ¨æ€æ–¹å¼è¿˜æ˜¯åŒæ­¥æ–¹å¼ï¼Œåªè¦èƒ½æ­£ç¡®åˆ¤æ–­è¿™æ®µä»£ç ç¡®å®å¯ä»¥å®‰å…¨åœ°è¿›è¡Œæ‹†åˆ†å…±ç”¨ï¼Œé‚£å°±å¹²å§ã€‚</p>

<p><em>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œéœ€è¦è®¾ç½® <code class="language-plaintext highlighter-rouge">minSize</code> ä»¥ä½¿ <code class="language-plaintext highlighter-rouge">react</code> èƒ½å¤Ÿæ­£ç¡®è¢«æ‹†åˆ†ï¼Œå› ä¸ºå®ƒå°äº 30kï¼Œåœ¨åŒæ­¥æ–¹å¼ä¸‹ï¼Œé»˜è®¤ä¸ä¼šè¢«æ‹†åˆ†å‡ºæ¥ï¼ˆè”æƒ³æ–‡ç« å¼€å¤´æåˆ°çš„é‚£äº›æ¡ä»¶ï¼‰ã€‚</em></p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">cacheGroups: {
</span> vendor: {
    chunks: "all",
    test: /[\\/]node_modules[\\/]/,
<span class="gi">+    minSize: 0,
</span> }
<span class="err">}</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/webpack-code-split-issue/assets/all.png" alt="`all` æ¨¡å¼ä¸‹çš„è¾“å‡º" /></p>

<p><em><code class="language-plaintext highlighter-rouge">all</code> æ¨¡å¼ä¸‹çš„è¾“å‡º</em></p>

<h3 id="ç»“è®º">ç»“è®º</h3>

<p>çœ‹èµ·æ¥ä¼¼ä¹ <code class="language-plaintext highlighter-rouge">all</code> æ˜¯æœ€å¥½çš„æ¨¡å¼ï¼Œå› ä¸ºå®ƒæœ€å¤§é™åº¦åœ°ç”Ÿæˆäº†å¤ç”¨çš„ä»£ç ï¼ŒWebpack é»˜è®¤å°±èµ°è¿™ä¸ªæ¨¡å¼æ‰“åŒ…ä¸å°±å¾—äº†ã€‚</p>

<p>åœ¨å¼€å¤´çš„æ—¶å€™æåˆ°è¿‡ä¸€ä¸ªåŸå› ä¸ºä½•é»˜è®¤æƒ…å†µä¸‹åªä¼˜åŒ– <code class="language-plaintext highlighter-rouge">async</code> ä»£ç ã€‚æ‰€ä»¥ï¼Œé™¤äº† <code class="language-plaintext highlighter-rouge">all</code> ä¹‹å¤–çš„å¦å¤–ä¸¤ä¸ªé€‰é¡¹æ˜¯æœ‰å­˜åœ¨æ„ä¹‰çš„ã€‚å¹¶ä¸”ï¼Œå…·ä½“çš„ä¼˜åŒ–åœºæ™¯éœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚è€Œå®šï¼Œ<code class="language-plaintext highlighter-rouge">all</code> æ‰€äº§ç”Ÿçš„æ•ˆæœå¹¶éæ‰€æœ‰æƒ…å†µä¸‹éƒ½éœ€è¦ã€‚</p>

<h3 id="ç›¸å…³èµ„æº">ç›¸å…³èµ„æº</h3>

<ul>
  <li><a href="https://webpack.js.org/plugins/split-chunks-plugin/">Webpack SplitChunksPlugin å®˜æ–¹æ–‡æ¡£</a></li>
  <li><a href="https://medium.com/dailyjs/webpack-4-splitchunks-plugin-d9fbbe091fd0">Webpack 4â€Šâ€”â€ŠMysterious SplitChunks Plugin</a></li>
</ul>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2019/03/09/React-useEffect-%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/" data-toggle="tooltip" data-placement="top" title="React useEffect ç›¸å…³é—®é¢˜">
                        Previous<br>
                        <span>React useEffect ç›¸å…³é—®é¢˜</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2019/03/26/Node.js-%E8%B0%83%E8%AF%95%E7%9B%B8%E5%85%B3/" data-toggle="tooltip" data-placement="top" title="Node.js è°ƒè¯•ç›¸å…³">
                        Next<br>
                        <span>Node.js è°ƒè¯•ç›¸å…³</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                



                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

 <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  <li>
    <a href="/feed.xml">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a href="https://twitter.com/liuwayong">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/wayou">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                   å·²ç»åˆ°åº•äº†ğŸ˜
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->



<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


  </body>
</html>
