<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="notes about the coding life">
    <meta name="keywords"  content="牛哇勇, 博客, 互联网, Web, JavaScript, 前端, 设计">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="创建 Yarn/NPM 脚手架快速生成项目 - 牛さんの部落格|刘哇勇的部落格">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="创建 Yarn/NPM 脚手架快速生成项目

背景

yarn create &lt;starter-kit-package&gt; [&lt;args&gt;] 是为了统一前端项目脚手架引入的，这之前，各项目会有自己的方式和姿势来生成新项目。

这里，约定 &lt;starter-kit-package&gt; 为 create- 开头的 npm 包，通过 package.json bin...">
    
    <meta property="article:published_time" content="2020-05-13T15:05:00Z">
    
    
    
    
    <meta property="og:image" content="http://0.0.0.0:4000">
    <meta property="og:url" content="http://0.0.0.0:4000/2020/05/13/%E5%88%9B%E5%BB%BA-Yarn-NPM-%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BF%AB%E9%80%9F%E7%94%9F%E6%88%90%E9%A1%B9%E7%9B%AE/">
    <meta property="og:site_name" content="牛さんの部落格|刘哇勇的部落格">
    
    <title>创建 Yarn/NPM 脚手架快速生成项目 - 牛さんの部落格|刘哇勇的部落格</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://0.0.0.0:4000/2020/05/13/%E5%88%9B%E5%BB%BA-Yarn-NPM-%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BF%AB%E9%80%9F%E7%94%9F%E6%88%90%E9%A1%B9%E7%9B%AE/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


  <!-- hack iOS CSS :active style -->
  <body ontouchstart="">
    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">牛さんの部落格</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">关于</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script> <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div> <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                    </div>
                    <h1>创建 Yarn/NPM 脚手架快速生成项目</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by 牛さんの部落格 on May 13, 2020</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<h1 id="创建-yarnnpm-脚手架快速生成项目">创建 Yarn/NPM 脚手架快速生成项目</h1>

<h2 id="背景">背景</h2>

<p><code class="language-plaintext highlighter-rouge">yarn create &lt;starter-kit-package&gt; [&lt;args&gt;]</code> 是为了统一前端项目脚手架引入的，这之前，各项目会有自己的方式和姿势来生成新项目。</p>

<p>这里，约定 <code class="language-plaintext highlighter-rouge">&lt;starter-kit-package&gt;</code> 为 <code class="language-plaintext highlighter-rouge">create-</code> 开头的 npm 包，通过 <a href="https://docs.npmjs.com/files/package.json#bin">package.json bin 字段</a>对外导出可执行命令用于创建新项目时执行。</p>

<p>当执行 <code class="language-plaintext highlighter-rouge">yarn create &lt;starter-kit-package&gt; [&lt;args&gt;]</code> 时，相当于执行 <code class="language-plaintext highlighter-rouge">yarn global add &lt;starter-kit-package&gt;</code>，只不过前者会自动调用 <code class="language-plaintext highlighter-rouge">&lt;starter-kit-package&gt;</code> 里的 bin 命令并透传 <code class="language-plaintext highlighter-rouge">args</code> 参数立即开始新项目的生成。</p>

<p>以 create-react-app 为例，生成项目可以这样：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn create react-app &lt;app-name&gt;
</code></pre></div></div>

<p>也可以这样：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn global add create-react-app
<span class="nv">$ </span>create-react-app &lt;app-name&gt;
</code></pre></div></div>

<h3 id="npm">npm</h3>

<p>npm 本身有一个 <code class="language-plaintext highlighter-rouge">init</code> 命令，用来快速创建 package.json 文件（yarn 对应的命令为 <code class="language-plaintext highlighter-rouge">yarn init</code>）。后期也加入了对 <code class="language-plaintext highlighter-rouge">create-</code> 脚手架的支持。</p>

<p>用法示例：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm init foo -&gt; npx create-foo
npm init @usr/foo -&gt; npx @usr/create-foo
npm init @usr -&gt; npx @usr/create
</code></pre></div></div>

<h2 id="创建-create--开头的脚手架">创建 <code class="language-plaintext highlighter-rouge">create-</code> 开头的脚手架</h2>

<p>由上面可知，<code class="language-plaintext highlighter-rouge">create-</code> 开头的脚手架 npm 包实际上是一个对外导出了可执行文件的 npm 包，所以 package.json 中需要实现 <code class="language-plaintext highlighter-rouge">bin</code> 字段，这与平时使用的命令行工具比如 <a href="https://github.com/webpack/webpack/blob/b7f08b42b85f89e52facac426251d26ec64f2e6d/package.json#L106">Webpack</a> 别无二致。</p>

<p>所以 bin 字段中提供的命令就是脚手架与外界沟通的桥梁，外界通过调用该命令，传递参数，调起脚手架。脚手架执行命令，解析参数，执行项目的生成逻辑。</p>

<h3 id="添加示例代码">添加示例代码</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>create-hello <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$_</span>
<span class="nv">$ </span>yarn init <span class="nt">-y</span>
<span class="nv">$ </span><span class="nb">touch </span>index.js
</code></pre></div></div>

<p>index.js 中输入：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#!/usr/bin/env node
</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<p>作为 bin 命令入口的文件需要以 <code class="language-plaintext highlighter-rouge">#!/usr/bin/env node</code>  开头，作用是告诉系统使用什么环境来执行该脚本。</p>

<p>编辑 package.json 加入 bin 字段的配置，指向刚刚添加的 index.js</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">{</span>
  "name": "create-hello",
  "version": "1.0.0",
  "main": "index.js",
<span class="gi">+  "bin": {
+     "create-hello": "./index.js"
+ },
</span>  "license": "MIT"
<span class="err">}</span>
</code></pre></div></div>

<h3 id="link">link</h3>

<p>创建项目后，需要 link 到全局，这样才能本地测试，就像使用正式发布的 npm 包一样调用。</p>

<p>直接在当前目录下执行：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn <span class="nb">link 
</span>yarn <span class="nb">link </span>v1.22.4
success Registered <span class="s2">"create-hello"</span><span class="nb">.</span>
info You can now run <span class="sb">`</span>yarn <span class="nb">link</span> <span class="s2">"create-hello"</span><span class="sb">`</span> <span class="k">in </span>the projects where you want to use this package and it will be used instead.
✨  Done <span class="k">in </span>0.03s.
</code></pre></div></div>

<p>完成 link 后，yarn 会创建可执行命令到对应路径下，具体的路径可通过 <code class="language-plaintext highlighter-rouge">yarn global bin</code> 来查看，</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn global bin
/usr/local/bin
</code></pre></div></div>

<p>然后查看该目录，可看到刚刚 link 成功的命令：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ll /usr/local/bin | <span class="nb">grep </span>create-hello                                                                                                                                                                                             19:56:26
lrwxr-xr-x  1 wayouliu  admin    63B May 13 18:02 create-hello -&gt; ../../../Users/wayouliu/.config/yarn/link/create-hello/index.js
</code></pre></div></div>

<h3 id="测试执行">测试执行</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn create hello                                                                                                                                                                                                                 19:56:31
yarn create v1.22.4
info Using linked package <span class="k">for</span> <span class="s2">"create-hello"</span><span class="nb">.</span>
/bin/sh: /usr/local/bin/create-hello: Permission denied
error Command failed.
Exit code: 126
Command: /usr/local/bin/create-hello
Arguments:
Directory: /Users/wayouliu/Documents/dev/tencent/test-tcnf
Output:

info Visit https://yarnpkg.com/en/docs/cli/create <span class="k">for </span>documentation about this command.
</code></pre></div></div>

<p>可以看到，并没有正常执行，提示权限问题。</p>

<p>真实原因是被 link 的入口文件其属性为非可执行，请看：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ll /usr/local/bin | <span class="nb">grep </span>create-hello                                                                                                                                                                                             19:56:26
lrwxr-xr-x  1 wayouliu  admin    63B May 13 18:02 create-hello -&gt; ../../../Users/wayouliu/.config/yarn/link/create-hello/index.js

<span class="nv">$ </span>ll /Users/wayouliu/.config/yarn/link/create-hello/index.js
total 16
<span class="nt">-rw-r--r--</span>  1 wayouliu  staff    43B May 13 17:57 index.js
<span class="nt">-rw-r--r--</span>  1 wayouliu  staff   145B May 13 18:01 package.json
</code></pre></div></div>

<p>这里生成到 <code class="language-plaintext highlighter-rouge">/usr/local/bin</code> 下的软链是 <code class="language-plaintext highlighter-rouge">x</code> 可执行的，但软链对应的实际文件，也就是项目中作为 bin 命令入口的 <code class="language-plaintext highlighter-rouge">index.js</code>，其属性不是 <code class="language-plaintext highlighter-rouge">x</code>。</p>

<p>解决办法是将其转一下：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo chmod </span>0777  /Users/wayouliu/.config/yarn/link/create-hello/index.js
</code></pre></div></div>

<p>再次查看其文件属性已经变化 ：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ll /Users/wayouliu/.config/yarn/link/create-hello/index.js                                        21:22:56
<span class="nt">-rwxrwxrwx</span>  1 wayouliu  staff    43B May 13 17:57 /Users/wayouliu/.config/yarn/link/create-hello/index.js
</code></pre></div></div>

<p>现在便可正常执行了：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn create hello 
yarn create v1.22.4
info Using linked package <span class="k">for</span> <span class="s2">"create-hello"</span><span class="nb">.</span>
hello
✨  Done <span class="k">in </span>1.24s.
</code></pre></div></div>

<p>另，还有种情况，也需要进行如上 <code class="language-plaintext highlighter-rouge">chmod</code> 操作来解决，即虽然 link 成功后在 <code class="language-plaintext highlighter-rouge">/usr/local/bin</code> 下生成了命令，但因为文件不是可执行属性，有可能会报找不到命令的错误：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fish: Unknown <span class="nb">command</span>: create-hello
</code></pre></div></div>

<h3 id="包含-scope-的情况">包含 scope 的情况</h3>

<p>对于包含 scope 的 npm 包，执行 <code class="language-plaintext highlighter-rouge">yarn create @foo/bar</code> 时，实际执行的是 <code class="language-plaintext highlighter-rouge">yarn global add @foo/create-bar</code>。</p>

<p>更新 package.json：</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">{</span>
-  "name": "create-hello",
<span class="gi">+  "name": "@tencent/create-hello",
</span>  "version": "1.0.0",
  "main": "index.js",
  "bin": {
      "create-hello": "./index.js"
   },
  "license": "MIT"
<span class="err">}</span>
</code></pre></div></div>

<p>执行 <code class="language-plaintext highlighter-rouge">yarn link</code> 重新 link。调试过程中难免多次进行 link 操作，所以如果之前已经 link 过同名包的话这里会失败，错误信息会类似下面这样：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn <span class="nb">link
</span>yarn <span class="nb">link </span>v1.22.4
warning There<span class="s1">'s already a package called "@tencent/create-hello" registered. This command has had no effect. If this command was run in another folder with the same name, the other folder is still linked. Please run yarn unlink in the other folder if you want to register this folder.
✨  Done in 0.03s.
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">yarn link</code> 生成的软链可以在 <code class="language-plaintext highlighter-rouge">~/.config/yarn/link</code> 目录找到，里面可看到所有 link 的包，通过 <code class="language-plaintext highlighter-rouge">yarn unlink</code> 可解决上面的告警。</p>

<h2 id="参数的处理">参数的处理</h2>

<p><code class="language-plaintext highlighter-rouge">yarn create &lt;starter-kit-package&gt; [&lt;args&gt;]</code> 中 <code class="language-plaintext highlighter-rouge">[&lt;args&gt;]</code> 部分会透传到 bin 命令，所以在 bin 命令的入口文件中接收处理即可。</p>

<p>更新 index.js：</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#!/usr/bin/env</span> node

- console.log('hello')
<span class="gi">+ console.log('hello',process.argv)
</span></code></pre></div></div>

<p>执行后的输出：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn create hello world                                                                                                                                                                                                     22:06:08
yarn create v1.22.4
info Using linked package <span class="k">for</span> <span class="s2">"create-hello"</span><span class="nb">.</span>
hello <span class="o">[</span>
  <span class="s1">'/Users/wayouliu/.nvm/versions/node/v14.0.0/bin/node'</span>,
  <span class="s1">'/usr/local/bin/create-hello'</span>,
  <span class="s1">'world'</span>
<span class="o">]</span>
✨  Done <span class="k">in </span>0.59s.
</code></pre></div></div>

<p>然后脚手架中就可以根据参数要求生成相应产出。</p>

<p>当然，参数处理这块一般使用成熟的三方库比如 <a href="https://www.npmjs.com/package/commander">commander</a>。</p>

<h2 id="相关资源">相关资源</h2>

<ul>
  <li><a href="https://classic.yarnpkg.com/en/docs/cli/create/">yarn create</a></li>
  <li><a href="https://classic.yarnpkg.com/blog/2017/05/12/introducing-yarn/">Yarn Create &amp; Yarn 1.0</a></li>
  <li><a href="https://docs.npmjs.com/cli/init">npm-init</a></li>
</ul>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2020/05/13/MySQL-%E9%87%8D%E7%BD%AE-root-%E5%AF%86%E7%A0%81/" data-toggle="tooltip" data-placement="top" title="MySQL 重置 root 密码">
                        Previous<br>
                        <span>MySQL 重置 root 密码</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2020/05/13/%E9%85%8D%E7%BD%AE-mac-Finder-%E5%A7%8B%E7%BB%88%E5%9C%A8%E6%96%B0%E6%A0%87%E7%AD%BE%E4%B8%AD%E6%89%93%E5%BC%80/" data-toggle="tooltip" data-placement="top" title="配置 mac Finder 始终在新标签中打开">
                        Next<br>
                        <span>配置 mac Finder 始终在新标签中打开</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                



                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

 <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  <li>
    <a href="/feed.xml">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a href="https://twitter.com/liuwayong">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/wayou">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; 牛さんの部落格 2020
                    <br>
                    Powered by <a href="http://huangxuan.me">Hux Blog</a> |
                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"
                        height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>
  </body>
</html>
