I"¶<h1 id="ä½¿ç”¨-shell-å‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾æ›¿æ¢">ä½¿ç”¨ shell å‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾æ›¿æ¢</h1>

<p>éœ€è¦ä½¿ç”¨åˆ° <code class="language-plaintext highlighter-rouge">sed</code> å‘½ä»¤ï¼Œä»¥ä¸‹æ˜¯æ¥è‡ª man page çš„ä»‹ç»ï¼š</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   sed - stream editor for filtering and transforming text
</code></pre></div>  </div>
</blockquote>

<p>ç¤ºä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s1">'s/toreplace/newcontent/gâ€™ somefile.txt 
</span></code></pre></div></div>

<p>ä»¥ä¸Šè„šæœ¬å°†æŸ¥æ‰¾ <code class="language-plaintext highlighter-rouge">somefile.txt</code> ä¸­ <code class="language-plaintext highlighter-rouge">toreplace</code> æ–‡æœ¬å¹¶æ›¿æ¢ä¸º <code class="language-plaintext highlighter-rouge">yoursetting</code>ã€‚å…¶ä¸­è¿™ä¸¤éƒ¨åˆ†éƒ½å¯ä»¥ä¸ºæ­£åˆ™è¡¨è¾¾å¼ã€‚</p>

<p>å…¶ä¸­ï¼Œ</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">s</code> è¡¨ç¤º substitute å³æ›¿æ¢ä¹‹æ„ï¼Œ</li>
  <li><code class="language-plaintext highlighter-rouge">g</code> è¡¨ç¤º globalï¼Œè¿›è¡Œå…¨å±€æ›¿æ¢è€Œä¸æ˜¯åªæ›¿æ¢ä¸€ä¸ª</li>
  <li><code class="language-plaintext highlighter-rouge">-i</code> è¡¨ç¤º in-place å³åŸåœ°æ›¿æ¢ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°æ–‡ä»¶</li>
  <li><code class="language-plaintext highlighter-rouge">-e</code> è¡¨ç¤ºæ‰§è¡Œéšåçš„å‘½ä»¤</li>
</ul>

<h2 id="å¤šæ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•æ‰«æ">å¤šæ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•æ‰«æ</h2>

<p>ä¸Šè¿°å‘½ä»¤åªæ‰«æå•ä¸ªæ–‡ä»¶ï¼Œå¦‚æœæƒ³æ‰«ææ•´ä¸ªç›®å½•ï¼Œå¯ç»“åˆ <code class="language-plaintext highlighter-rouge">find</code> æ¥å®ç°ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>find <span class="nb">.</span> <span class="nt">-type</span> f <span class="nt">-exec</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s1">'s/foo/xxx/g'</span> <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div></div>

<p>å¦‚æœä¸Šè¿°å‘½ä»¤æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span>: RE error: illegal byte sequence
</code></pre></div></div>

<p>éœ€è¦è®¾ç½®å½“å‰å‘½ä»¤è¡Œçš„ <code class="language-plaintext highlighter-rouge">LANG</code> å˜é‡ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export LC_CTYPE=C 
export LANG=C
</code></pre></div></div>

<h2 id="ç»“åˆ-grep">ç»“åˆ grep</h2>

<p>éœ€è¦æ‰¹é‡å¤„ç†æ–‡ä»¶æ—¶ï¼Œä¹Ÿå¯ç»“åˆ grep å®ç°ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-rl</span> foo <span class="nb">.</span> | xargs <span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s1">'s/foo/xxx/g'</span>
</code></pre></div></div>

<h2 id="ç›¸å…³èµ„æº">ç›¸å…³èµ„æº</h2>

<ul>
  <li><a href="https://coderwall.com/p/2ivpsg/recursive-find-replace-with-sed">Recursive find &amp; replace with sed</a></li>
  <li><a href="https://stackoverflow.com/a/11287641/1553656">Getting â€œsed error - illegal byte sequenceâ€ (in bash) [duplicate]</a></li>
</ul>

:ET